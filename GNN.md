## 1 图数据
图数据是一种用于表示实体及其关系的数据结构。
基本构成包括：
- **节点（Vertex）**：图中的基本元素，代表实体，如社交网络中的用户。
- **边（Edge）**：连接两个节点的线，代表节点之间的关系，如用户之间的友谊。
- **权重（Weight）**：边可以具有权重，表示关系的强度或重要性，如道路网络中边的权重可以表示道路的长度或通行时间。

## 2 网络构造
GNN的核心思想是通过聚合邻居节点的信息来更新当前节点的表示。这一过程通常包括以下几个关键步骤：
1. **初始化节点表示**：为每个节点分配一个初始的特征向量，通常基于节点的属性信息。
2. **邻居聚合**：根据节点的邻居信息，通过聚合函数（如求和、平均、最大池化等）更新节点表示。
3. **节点更新**：结合节点自身的特征和聚合后的邻居信息，通过更新函数（如非线性激活函数）更新节点表示。
4. **输出表示**：根据任务需求，从更新后的节点表示中提取输出信息，用于节点分类、图分类、链接预测等任务。

#### 2.1 节点初始化
在这一阶段，每个节点被赋予一个初始的特征向量，这些特征向量通常基于节点的属性信息。例如，在社交网络中，节点的属性可能包括用户的年龄、性别、兴趣爱好等。这些属性信息被编码成数值向量，作为节点的初始表示。

初始化节点表示的方法有多种，常见的包括：
- **独热编码（One-Hot Encoding）**：为每个节点分配一个唯一的向量，向量中只有一个元素为1，其余元素为0。这种方法简单直观，但不包含节点的属性信息。
    
- **基于属性的编码**：将节点的属性信息直接转换为数值向量。例如，对于一个用户节点，其年龄可以转换为一个数值，性别可以转换为0或1，兴趣爱好可以转换为多个数值。
    
- **预训练嵌入（Pre-trained Embeddings）**：使用预训练的模型（如Word2Vec、GloVe等）为节点生成初始嵌入。这种方法在处理文本数据时特别有效，可以捕捉节点之间的语义关系。

另外，对于一张图片，往往为用下面的方法进行初始化：
1. ​**像素级表示**  
	每个像素作为节点，通过虚拟边连接相邻像素。此时节点特征是像素的RGB值或灰度值。但这种方法会导致节点*数量庞大*，计算复杂度高，实际应用较少。
    
2. ​**区域块划分**  
    将图像分割为局部区域（如超像素或网格块），每个区域作为一个节点，节点特征可包括：
    - 颜色直方图
    - 纹理特征（如LBP、HOG）
    - CNN提取的局部区域特征   
3. ​**预训练CNN特征提取**  
    使用预训练的卷积神经网络（如ResNet、VGG）提取图像的高层语义特征：
    - ​**全局特征**：将全图输入CNN，取倒数第二层输出作为单一节点特征
    - ​**局部特征**：对图像分块后分别提取特征，每个分块作为图中的一个节点

在人脸情绪识别中，一般合面部结构的先验知识，先进行**关键点定位与特征提取**（Dlib工具），对每个关键点提取以该点为中心的局部图像块，输入CNN获取特征向量，邻接矩阵根据关键点间的解剖学关系等，构建图结构

#### 2.2 邻居聚合过程
邻居聚合是GNN的核心步骤之一，其目的是通过聚合邻居节点的信息来更新当前节点的表示。这一过程通常包括以下几个关键步骤：
- **选择聚合函数**：聚合函数用于将邻居节点的特征向量合并为一个向量。常见的聚合函数包括求和、平均、最大池化等。
- **计算邻居特征**：对于每个节点，遍历节点的邻接列表，计算其邻居节点的特征向量。
- **应用聚合函数**：将邻居节点的特征向量通过选定的聚合函数合并为一个向量。例如，如果选择平均聚合，那么每个邻居节点的特征向量将被平均，得到一个代表邻居信息的向量。

#### 2.3 节点更新
目的是结合节点自身的特征和聚合后的邻居信息来更新节点的表示。这一过程通常包括以下几个关键步骤：
1. **结合自身特征和邻居信息**：将节点自身的特征向量与聚合后的邻居特征向量结合。这可以通过拼接、加权求和等方式实现。
2. **应用更新函数**：通过更新函数（如非线性激活函数）更新节点的表示。更新函数可以是非线性的，以增加模型的表达能力。

通过上述步骤，GNN能够逐步更新节点的表示，最终学习到图的整体结构特征。这些更新后的节点表示可以用于各种图相关的任务，如节点分类、图分类、链接预测等。